<div class="row">
	<div class="span12">
		<div class="page-header">
			<h1>Your Account</h1>
			<p>Here's an overview of your puchases.</p>
		</div>
	</div>
</div>

<%
Date.prototype.pad = function (n) {
	return (n < 10) ? '0' + n : n;
};

Date.prototype.toISODateTime = function () {
	return this.getFullYear() + '-'
		+ this.pad(this.getMonth() + 1) + '-'
		+ this.pad(this.getDate()) + 'T'
		+ this.pad(this.getHours()) + ':'
		+ this.pad(this.getMinutes()) + ':'
		+ this.pad(this.getSeconds());
};

var formatMoney = function (n, c, d, t) {
	var c = isNaN(c = Math.abs(c)) ? 2 : c, d = d == undefined ? "," : d, t = t == undefined ? "." : t, s = n < 0 ? "-" : "", i = parseInt(n = Math.abs(+n || 0).toFixed(c)) + "", j = (j = i.length) > 3 ? j % 3 : 0;
	return s + (j ? i.substr(0, j) + t : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
};

var displayBalance = formatMoney(balance / 100, 2, '.', "'");
var posneg = (balance < 0) ? 'negative' : 'positive';
%>

<div class="row">
	<div class="span12">
		<div class="well">
			<p class="balance <%= posneg %>"><%= displayBalance %></p>
		</div>

<table class="table table-striped table-bordered">
	<thead>
		<tr>
			<th>Date</th>
			<th>Item</th>
			<th>$$$</th>
		</tr>
	</thead>
	<tbody>
		<% for (var i = account.length -1; i >= 0; --i) { %>
		<tr>
			<td><time><%= new Date(account[i].time).toISODateTime() %></time></td>
			<td><%= items[account[i].item].name %></td>

			<% var posneg = (account[i].amount < 0) ? 'negative' : 'positive'; %>
			<td style="text-align: right;" class="<%= posneg %>"><%= formatMoney(account[i].amount / 100, 2, '.', "'") %></td>
		</tr>
		<% } %>
	</tbody>
</table>


	</div>
</div>


<div class="row" style="margin-top: 36px; margin-bottom: 36px;">
	<div class="span12" style="text-align: center;">
		<a class="btn btn-large" href="/">Home</a>
	</div>
</div>
